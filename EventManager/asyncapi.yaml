asyncapi: 3.0.0
info:
  title: EventManager
  version: 1.0.0
servers:
  mosquitto:
    host: mosquitto:1883
    protocol: mqtt

channels:
  healthRecords:
    address: health/records
    messages:
      healthRecordMessage:
        $ref: "#/components/messages/healthRecord"

  healthData:
    address: health/data
    messages:
      healthRecordMessage:
        $ref: "#/components/messages/healthRecord"

operations:
  receiveHealthRecord:
    action: receive
    channel:
      $ref: "#/channels/healthRecords"

  forwardHealthRecord:
    action: send
    channel:
      $ref: "#/channels/healthData"

components:
  messages:
    healthRecord:
      payload:
        type: object
        properties:
          recordId:
            type: integer
          athleteId:
            type: string
          timestamp:
            type: string
            format: date-time
          heartRate:
            type: number
          bodyTemperature:
            type: number
          bloodPressure:
            type: string
          bloodOxygen:
            type: number
          stepCount:
            type: number
          activityStatus:
            type: integer
          latitude:
            type: number
          longitude:
            type: number
          secureTransmissionStatus:
            type: number
        required:
          - athleteId
          - timestamp
          - heartRate
          - bodyTemperature
          - bloodPressure
          - bloodOxygen
          - stepCount
          - activityStatus
          - latitude
          - longitude
          - secureTransmissionStatus
